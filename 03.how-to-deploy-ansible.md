# 現代 IT 人一定要知道的 Ansible 自動化組態技巧

## 03. 怎麼部署 Ansible 環境？

<!-- (前言) -->

在本次的章節裡，凍仁將介紹 Ansible 的基本觀念、怎麼安裝 Ansible 和環境設定。

![automate_with_ansible_basic-11.jpg](imgs/automate_with_ansible_basic-11.jpg)


### Ansible 是怎麼運作的？

<!-- (說明架構) -->

在 Ansible 的世界裡，我們會透過 **inventory 檔案**來定義有哪些 **Managed node** (被控端)，並藉由 **SSH** 和 **Python** 進行溝通。

![automate_with_ansible_basic-12.jpg](imgs/automate_with_ansible_basic-12.jpg)

換句話說就是，Control Machine (主控端) 只要可以用 SSH 連上 Managed node，且被連上的機器裡有預載 Python，Ansible 就可以運作了！

- `Control Machine` 指的是我們主要會在上面操作 Ansible 的機器，凍仁喜歡用**主控端**來形容它。它可以是我們平時用的電腦、手機 [^1] 或機房裡的某一台機器，也可以把它想成是一般 Lab 練習裡的 `Workstation`。

- `Managed node` 則是被 Ansible 操縱的機器，凍仁喜歡用**被控端**來形容它。在很多的 Lab 練習裡則用 `Server` 來稱呼它。


### 怎麼安裝 Ansible？

 Control Machine

1. Control Machine (主控端) 需安裝 Ansible。
2. Managed node 需安裝 OpenSSH server 和 Python。




(怎麼在 Control machine 安裝 ansible)

只需在 Control Machine 安裝 Ansible；Managed node 則要滿足 Python 2.5 以上和開通 SSH 的條件。

Ansible 最新的版本為 v2.1。

![automate_with_ansible_basic-13.jpg](imgs/automate_with_ansible_basic-13.jpg)

礙於版面，這邊只提到凍仁常用的環境，其它的部份可參考凍仁與 Ansible 台灣使用者社群一同維護的 [安裝 Ansible](http://ansible.tw/#!docs/installation.md) 教學。




### 怎麼設定 Ansible？

若有本機測試需求，建議於 Control Machine 的 /etc/ansible/hosts 補上 `local` 的設定。

我們可以藉由 ansible.cfg 來設定 inventory 的位置、被控端的相關設定。

![automate_with_ansible_basic-14.jpg](imgs/automate_with_ansible_basic-14.jpg)

#### inventory 是什麼？

我們可以把 inventory 想像成是把設定檔和主機列表拆開的設定檔 …、

inventory 就字面上有 "詳細目錄"、"完整清單" 的意思。在 Ansible 是用來定義被控端的主機位址、群組還有 ssh 連線資訊。

![automate_with_ansible_basic-15.jpg](imgs/automate_with_ansible_basic-15.jpg)


### 資料來源

* [凍仁的筆記: 現代 IT 人一定要知道的 Ansible 自動化組態技巧](http://note.drx.tw/2016/05/automate-with-ansible-basic.html)

[^1]: 相信在這個智慧型手機裡盛行的時代，要在手機裡裝個 Python 和 OpenSSH 一定不是什麼難事 (笑)。在台灣還有人整合了 Ansible 與聊天機器人 (Chatbot)，這樣出門在外只要有手機和網路就可以遠端工作了！(詳情請參考[從 DevOps 到 ChatOps：War Room、Bots 與 Automation][devops-chatopswar-roombots-automation] 的簡報)

[devops-chatopswar-roombots-automation]: http://www.slideshare.net/warfan/devops-chatopswar-roombots-automation
